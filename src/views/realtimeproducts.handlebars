<section class="page">
  <header class="page-header">
    <div>
      <h1 class="page-title">Productos en tiempo real</h1>
      <p class="page-subtitle">
        Agregá o eliminá productos y mirá cómo se actualiza el listado al instante.
      </p>
    </div>

    <nav class="page-actions">
      <a href="/" class="btn btn-outline">Volver al listado normal</a>
      <a href="/api/products" class="btn btn-ghost" target="_blank">Ver API JSON</a>
    </nav>
  </header>

  <noscript>
    <p style="padding:12px; border:1px solid #ddd; border-radius:8px;">
      ⚠️ Para usar el tiempo real necesitás habilitar JavaScript en el navegador.
    </p>
  </noscript>

  <section class="realtime-layout">
    <section class="panel">
      <header class="panel__header">
        <h2 class="panel__title">Crear producto</h2>
        <p class="panel__subtitle">
          Completá los campos para crear un nuevo producto.
        </p>
      </header>

      <!-- ✅ method/action para evitar GET en la URL -->
      <form id="productForm" class="form-grid" method="post" action="#" autocomplete="off">
        <input name="title" placeholder="Título" class="input" required />
        <input name="description" placeholder="Descripción" class="input" required />
        <input type="number" name="price" placeholder="Precio" class="input" min="0" required />
        <input name="category" placeholder="Categoría" class="input" required />
        <input name="code" placeholder="Código" class="input" required />
        <input type="number" name="stock" placeholder="Stock" class="input" min="0" required />

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            Crear
          </button>
        </div>
      </form>
    </section>

    <section class="panel">
      <header class="panel__header">
        <h2 class="panel__title">Eliminar producto</h2>
        <p class="panel__subtitle">
          Indicá el ID del producto que querés eliminar.
        </p>
      </header>

      <!-- ✅ method/action para evitar GET en la URL -->
      <form id="deleteForm" class="form-inline" method="post" action="#" autocomplete="off">
        <input
          name="id"
          placeholder="ID del producto a eliminar"
          class="input"
          type="text"
          required
        />
        <button type="submit" class="btn btn-outline">
          Eliminar
        </button>
      </form>
    </section>
  </section>

  <section class="panel panel-products">
    <header class="panel__header">
      <h2 class="panel__title">Listado (tiempo real)</h2>
      <p class="panel__subtitle">
        Esta lista se actualiza automáticamente cuando se crean o eliminan productos.
      </p>
    </header>

    <div id="productsContainer" class="products-grid">
      {{#each products}}
        <article class="product-card">
          <header class="product-card__header">
            <h3 class="product-card__title">{{this.title}}</h3>
            <span class="product-card__price">${{this.price}}</span>
          </header>

          <p class="product-card__description">
            {{this.description}}
          </p>

          <ul class="product-card__meta">
            <li><strong>Categoría:</strong> {{this.category}}</li>
            <li><strong>Código:</strong> {{this.code}}</li>
            <li><strong>Stock:</strong> {{this.stock}}</li>
            <li><strong>ID:</strong> {{this._id}}</li>
          </ul>
        </article>
      {{/each}}
    </div>
  </section>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/realtime.js"></script>
</section>
